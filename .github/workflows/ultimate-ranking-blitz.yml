name: Ultimate Ranking Blitz

on:
  schedule:
    - cron: '0 */3 * * *'  # Every 3 hours for maximum impact
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  ranking-acceleration:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      - name: Run SEO Automation Scripts
        run: |
          echo "ðŸš€ Starting Ultimate Ranking Blitz..."
          
          # Update sitemap timestamps
          if [ -f "public/sitemap.xml" ]; then
            sed -i "s/<lastmod>[^<]*<\/lastmod>/<lastmod>$(date +%Y-%m-%d)<\/lastmod>/g" public/sitemap.xml
            echo "âœ… Sitemap timestamps updated"
          fi
          
          # Run manual SEO update if available
          if [ -f "manual-seo-update.js" ]; then
            node manual-seo-update.js
            echo "âœ… SEO automation completed"
          fi
          
          # Run comprehensive test if available
          if [ -f "comprehensive-seo-test.js" ]; then
            node comprehensive-seo-test.js
            echo "âœ… SEO validation completed"
          fi

      - name: Set up GitHub credentials
        run: |
          git config --global user.name "ranking-blitz-bot"
          git config --global user.email "info@justlegalsolutions.org"
          
      - name: Commit and Push Changes
        run: |
          git add .
          git diff --staged --quiet || git commit -m "ðŸš€ Ultimate Ranking Blitz: $(date '+%Y-%m-%d %H:%M UTC')"
          git push
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
